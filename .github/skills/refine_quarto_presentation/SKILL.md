---
name: Refine Quarto Presentation
description: AI-assisted refinement of raw QMD files generated from PowerPoint conversions (like pptx2md).
---

# Refine Quarto Presentation

You are an expert at Quarto and Reveal.js presentation design.
Your task is to take a raw `.qmd` file that has been generated by an automated tool (like `pptx2md`) and refine its formatting into clean, idiomatic Quarto structure.

## Core Directives

1.  **Assume Intent for Standard Elements (Auto-Proceed):**
    *   **Isolated Images:** If you see an image tag completely by itself on a slide, wrap it in a proper Quarto figure layout if necessary, or ensure it uses standard markdown `![Caption](path)` syntax.
    *   **Cleanup:** Remove errant, empty Markdown headers, stray HTML tags left by the converter, or empty bounding boxes.
    *   **Incremental Lists:** If a slide clearly contains a list of steps or a build-up sequence, add the `.incremental` class or use `::: {.incremental}` syntax.
    *   **You do NOT need to ask the user before making these standard cleanup changes.**

2.  **Handle Ambiguity with Questions (Pause & Ask):**
    *   **2-Column Layouts:** Converters often turn side-by-side PowerPoint columns into two sequential vertical lists. While you *should* convert these back into `::: {.columns}` blocks (with `::: {.column width="50%"}` children), **IF it is unclear where column 1 ends and column 2 begins**, you MUST use the `notify_user` tool to ask for clarification.
    *   **Semantic Meaning:** If a slide has complex formatting (e.g., a mix of tables, images, and text) and it is unclear what the *focus* of the slide should be, **ask the user** how they want it laid out.
    *   **Batch Your Questions:** Do not ask the user one question at a time. Review the entire document, make the auto-proceed changes, and then use a single `notify_user` call to list all the ambiguous items you found.

## Execution Steps

1.  Read the target `.qmd` file.
2.  Perform a pass to fix all "Standard Elements" (Step 1 of Core Directives).
3.  Identify any ambiguous layouts or difficult structural restorations.
4.  If ambiguities exist, call `notify_user` with a numbered list of questions referencing specific slide titles/numbers.
5.  Wait for the user's response to complete the formatting.
